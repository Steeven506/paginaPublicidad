---
const { id = 'login-modal' } = Astro.props;
---

<div 
  id={id}
  x-data="{ 
    open: false,
    formData: { email: '', password: '' },
    error: '',
    toggle() { this.open = !this.open },
    close() { this.open = false },
    submitForm() {
      this.error = '';
      
      if (!this.formData.email || !this.formData.password) {
        this.error = 'Por favor completa todos los campos';
        return;
      }
      
      if (!/^\S+@\S+\.\S+$/.test(this.formData.email)) {
        this.error = 'Por favor ingresa un email válido';
        return;
      }
      
      console.log('Datos enviados:', this.formData);
      this.formData = { email: '', password: '' };
      this.close();
    }
  }"
  x-show="open"
  @keydown.escape.window="close()"
  @open-login.window="open = true"
  class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"
  style="display: none;"
  x-cloak
>
  <div 
    class="bg-white rounded-lg shadow-xl w-full max-w-md relative animate-fade-in"
    @click.stop
  >
    <button 
      @click="close()"
      class="absolute top-3 right-3 text-gray-500 hover:text-gray-700 text-2xl bg-transparent border-none cursor-pointer"
      aria-label="Cerrar modal"
    >
      &times;
    </button>
    
    <div class="p-6">
      <h2 class="text-2xl font-bold mb-6 text-gray-800 text-center">Iniciar Sesión</h2>
      
      <template x-if="error">
        <div class="mb-4 p-3 bg-red-50 text-red-600 rounded-md text-sm" x-text="error"></div>
      </template>
      
      <form @submit.prevent="submitForm" class="space-y-4">
      </form>
    </div>
  </div>
</div>

<style is:global>
  [x-cloak] { display: none !important; }
  .animate-fade-in {
    animation: fadeIn 0.3s ease-out;
  }
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
  }
</style>